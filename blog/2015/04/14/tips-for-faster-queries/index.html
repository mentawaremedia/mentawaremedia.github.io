
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Tips for Faster Queries - Very Good Indicators</title>
  <meta name="author" content="Mentaware Media">

  
  <meta name="description" content="For the last few weeks I&rsquo;ve been busy at work optimizing many of our
slowest queries. On my last Rails related post I covered a work around &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.verygoodindicators.com/blog/2015/04/14/tips-for-faster-queries/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Very Good Indicators" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>

  
  
    
  
  
  
  

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href='//fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Imprima' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Abel' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Armata' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Droid+Sans:400,700' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-57121489-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Very Good Indicators</a></h1>
  
    <h2>Experience by design</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<section id="newsletter">
  <div class="message">
    <h2>ENJOY THIS CONTENT? GO PRO.</h2>
    <p style="float:left;">Join our exclusive group free. Get special content, gifts, and more. Never get spam. Just cool, fun stuff.</p>
  </div>
  <!-- Begin MailChimp Signup Form -->
  <div id="mc_embed_signup">
    <form action="//verygoodindicators.us9.list-manage.com/subscribe/post?u=9bd40e85413afa149c5a251ca&amp;id=e4096287ef" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
        <div id="mc_embed_signup_scroll">
          <div class="mc-field-group email-field">
            <label for="mce-EMAIL"></label>
            <input type="email" placeholder="Enter your email here" value="" name="EMAIL" class="required email" id="mce-EMAIL">
          </div>
          <div class="clear submit-button">
            <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
          </div>          
          <div id="mce-responses" class="clear">
            <div class="response" id="mce-error-response" style="display:none"></div>
            <div class="response" id="mce-success-response" style="display:none"></div>
          </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
          <div style="position: absolute; left: -5000px;">
            <input type="text" name="b_9bd40e85413afa149c5a251ca_e4096287ef" tabindex="-1" value="">
          </div>

        </div>
    </form>
  </div>

<!--End mc_embed_signup-->

</section>

<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Tips for Faster Queries</h1>
      <div class="sharing" style="">
  
  <!-- Place this tag where you want the su badge to render -->
  <div style="display: inline-block; vertical-align: top;">
    <su:badge layout="5"></su:badge>
  </div>
  
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.verygoodindicators.com/blog/2015/04/14/tips-for-faster-queries/" data-via="mentawaremedia" data-counturl="http://www.verygoodindicators.com/blog/2015/04/14/tips-for-faster-queries/" style="display: inline-block; vertical-align: top;">Tweet</a>
  
  
  <div class="g-plusone" data-size="medium" style="display: inline-block; vertical-align: top;"></div>
  
  
  <div class="fb-like" data-send="true" data-width="450" data-show-faces="false" style="display: inline-block; vertical-align: top;"></div>
  
</div>

    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-04-14T19:54:54-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>7:54 pm</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://www.verygoodindicators.com">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p><img class="right" src="/images/fast_snail.jpg" width="300"></p>

<p>For the last few weeks I&rsquo;ve been busy at work optimizing many of our
slowest queries. On my last Rails related post I covered a work around for
PostgreSQL&rsquo;s inherit slowness with COUNT queries. On this post I&rsquo;m covering
some common tips for speeding up general queries.</p>

<p>We&rsquo;ll start by looking at some code.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#app/serializers/business_serializer.rb</span>
</span><span class='line'><span class="k">class</span> <span class="nc">BusinessSerializer</span> <span class="o">&lt;</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializer</span>
</span><span class='line'>  <span class="n">attributes</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:zip</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#app/controllers/businesses_controller#any_ten_records</span>
</span><span class='line'><span class="no">Business</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;revenue + ? = ?&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">[</span><span class="ss">:amount</span><span class="o">]</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="ss">:created_at</span><span class="p">)</span><span class="o">.</span><span class="n">to_a</span><span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>In the code above I use <a href="https://github.com/rails-api/active_model_serializers">ActiveModel::Serializers</a>
to describe which model attributes will be serialized into JSON. If you are unfamiliar
with this gem consider reading up on it. It&rsquo;s pretty handy for DRYing up your code. The
database I am using is PostgreSQL.</p>

<h2>Don&rsquo;t SELECT *</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#Business.where(&quot;revenue + ? = ?&quot;, params[:amount], 100).order(:created_at).to_a.first(10)</span>
</span><span class='line'><span class="no">Business</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:zip</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;revenue + ? = ?&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">[</span><span class="ss">:amount</span><span class="o">]</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="ss">:created_at</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">to_a</span>
</span><span class='line'>  <span class="o">.</span><span class="n">first</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>The serailizer tells me that the only thing I need to return is <code>business#name</code>
and <code>business#zip</code>. The more record columns you request data on, the slower your
query might run as it will use more Network I/O and sometimes Disk I/O.
You could boost performance by selecting only the columns you require.</p>

<h2>Filter Rows With Limit</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#Business.select(:name, :zip)</span>
</span><span class='line'><span class="c1">#  .where(&quot;revenue + ? = ?&quot;, params[:amount], 100)</span>
</span><span class='line'><span class="c1">#  .order(:created_at)</span>
</span><span class='line'><span class="c1">#  .to_a</span>
</span><span class='line'><span class="c1">#  .first(10)</span>
</span><span class='line'><span class="no">Business</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:zip</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;revenue + ? = ?&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">[</span><span class="ss">:amount</span><span class="o">]</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="ss">:created_at</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>We can see from <code>#first(10)</code> that we are only interested in returning the first
ten records we fetched from the query. We could potentially and unnecessarily
request a huge record set and consume a ton of memory by instantiating those
records as ActiveRecord objects.</p>

<h2>Avoid Sorting</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#Business.select(:name, :zip)</span>
</span><span class='line'><span class="c1">#  .where(&quot;revenue + ? = ?&quot;, params[:amount], 100)</span>
</span><span class='line'><span class="c1">#  .limit(10)</span>
</span><span class='line'><span class="c1">#  .order(:created_at)</span>
</span><span class='line'><span class="no">Business</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:zip</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;revenue + ? = ?&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">[</span><span class="ss">:amount</span><span class="o">]</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Sorting is sometimes unavoidable but we should try not to utilize it when
possible. The <code>ORDER BY</code> generated will consume sorting memory on the server.
In cases where memory becomes scarce on the server, it will spill over to
disk making it painfully slow.</p>

<h2>Don&rsquo;t Accidentally Skip Using an Index</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#Business.select(:name, :zip)</span>
</span><span class='line'><span class="c1">#  .where(&quot;revenue + ? = ?&quot;, params[:amount], 100)</span>
</span><span class='line'><span class="c1">#  .limit(10)</span>
</span><span class='line'><span class="no">Business</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:zip</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="s2">&quot;revenue = ? - ?&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">params</span><span class="o">[</span><span class="ss">:amount</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>If the businesses table is using an index on the field revenue, the original code
would skip using the index. To take advantage of the index we need to shift the
calculation from the left hand side of the equation to the right hand side.</p>

<p>Thanks you coming by. Feel free to share and comment below.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Mentaware Media</span></span>

      




<time class='entry-date' datetime='2015-04-14T19:54:54-05:00'><span class='date'><span class='date-month'>Apr</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>7:54 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/programming/'>programming</a>
  
</span>


    </p>
    
      <div class="sharing" style="">
  
  <!-- Place this tag where you want the su badge to render -->
  <div style="display: inline-block; vertical-align: top;">
    <su:badge layout="5"></su:badge>
  </div>
  
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://www.verygoodindicators.com/blog/2015/04/14/tips-for-faster-queries/" data-via="mentawaremedia" data-counturl="http://www.verygoodindicators.com/blog/2015/04/14/tips-for-faster-queries/" style="display: inline-block; vertical-align: top;">Tweet</a>
  
  
  <div class="g-plusone" data-size="medium" style="display: inline-block; vertical-align: top;"></div>
  
  
  <div class="fb-like" data-send="true" data-width="450" data-show-faces="false" style="display: inline-block; vertical-align: top;"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/04/12/build-measure-learn/" title="Previous Post: build measure learn">&laquo; build measure learn</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
<section>
    <h1>Related Articles</h1>
    <ul class="posts">
    
        <li class="related">
        <a href="/blog/2015/04/07/faster-count-queries/">Faster Count Queries</a>
        </li>
    
        <li class="related">
        <a href="/blog/2015/03/15/ruby-contructors/">ruby constructors</a>
        </li>
    
        <li class="related">
        <a href="/blog/2015/03/20/class-class/">class Class</a>
        </li>
    
        <li class="related">
        <a href="/blog/2015/03/22/a-blow-against-grammar-nazis/">a blow against grammar nazis</a>
        </li>
    
        <li class="related">
        <a href="/blog/2015/04/12/build-measure-learn/">build measure learn</a>
        </li>
    
    </ul>
</section>

<section>
  <h1>Topics</h1>
    <ul id="category-list" class="group"><li><a href='/blog/categories/biohacking'>biohacking (2)</a></li><li><a href='/blog/categories/books'>books (3)</a></li><li><a href='/blog/categories/debt'>debt (2)</a></li><li><a href='/blog/categories/diet'>diet (1)</a></li><li><a href='/blog/categories/funny'>funny (2)</a></li><li><a href='/blog/categories/linguistics'>linguistics (1)</a></li><li><a href='/blog/categories/low-carb'>low carb (3)</a></li><li><a href='/blog/categories/making-money'>making money (3)</a></li><li><a href='/blog/categories/performance'>performance (3)</a></li><li><a href='/blog/categories/programming'>programming (5)</a></li><li><a href='/blog/categories/recipes'>recipes (2)</a></li><li><a href='/blog/categories/technology'>technology (1)</a></li><li><a href='/blog/categories/tgif'>tgif (2)</a></li></ul>
</section>



<section style="clear: both">
  <h1>Keywords</h1>
    <span id="tag-cloud"><a href='/blog/tags/-100-startup' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>$100 startup</a> <a href='/blog/tags/80-20' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>80/20</a> <a href='/blog/tags/athletic-performance' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>athletic performance</a> <a href='/blog/tags/bake-free' style='font-size: 124.0%; padding: 0.2em 0.2em 0.2em 0.2em'>bake free</a> <a href='/blog/tags/binding-object' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>Binding object</a> <a href='/blog/tags/books' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>books</a> <a href='/blog/tags/breakfast' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>breakfast</a> <a href='/blog/tags/chocolate' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>chocolate</a> <a href='/blog/tags/class-class' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>class Class</a> <a href='/blog/tags/constructors' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>constructors</a> <a href='/blog/tags/credit-card' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>credit card</a> <a href='/blog/tags/debt' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>debt</a> <a href='/blog/tags/dessert' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>dessert</a> <a href='/blog/tags/diaphragm' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>diaphragm</a> <a href='/blog/tags/entrepreneurship' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>entrepreneurship</a> <a href='/blog/tags/grammar' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>grammar</a> <a href='/blog/tags/grammar-nazi' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>grammar nazi</a> <a href='/blog/tags/income' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>income</a> <a href='/blog/tags/lungs' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>lungs</a> <a href='/blog/tags/o2' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>o2</a> <a href='/blog/tags/o2-trainer' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>o2 trainer</a> <a href='/blog/tags/oatmeal' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>oatmeal</a> <a href='/blog/tags/pareto-principle' style='font-size: 112.0%; padding: 0.1em 0.1em 0.1em 0.1em'>pareto principle</a> <a href='/blog/tags/postgres' style='font-size: 124.0%; padding: 0.2em 0.2em 0.2em 0.2em'>postgres</a> <a href='/blog/tags/rails' style='font-size: 124.0%; padding: 0.2em 0.2em 0.2em 0.2em'>rails</a> <a href='/blog/tags/ror' style='font-size: 124.0%; padding: 0.2em 0.2em 0.2em 0.2em'>ror</a> <a href='/blog/tags/ruby' style='font-size: 160.0%; padding: 0.5em 0.5em 0.5em 0.5em'>ruby</a> </span>
</section>
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Mentaware Media -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'verygoodindicators';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.verygoodindicators.com/blog/2015/04/14/tips-for-faster-queries/';
        var disqus_url = 'http://www.verygoodindicators.com/blog/2015/04/14/tips-for-faster-queries/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




<!-- Place this snippet wherever appropriate -->
<script type="text/javascript">
  (function() {
    var li = document.createElement('script'); li.type = 'text/javascript'; li.async = true;
    li.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + '//platform.stumbleupon.com/1/widgets.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(li, s);
  })();
</script>




</body>
</html>
